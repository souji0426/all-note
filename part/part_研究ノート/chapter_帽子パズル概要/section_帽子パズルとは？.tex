\documentclass[C:/souji/all-note/note]{subfiles}

\begin{document}

私の研究対象は主に帽子パズルで,
その内容は以下のようなものです.

\begin{puzzle}
  \label{puzzle:hat-Hardin-Taylor}
  看守があるゲームをするために2人の囚人を同じ部屋に入れ,
  帽子を1人に1つずつ被せます.
  その帽子は黒白どちらかの色で塗られています.
  囚人2人はそれぞれ自分が被っている帽子の色は分かりませんが,
  もう1人の囚人の帽子の色は見えています.
  また部屋に入ってからは互いに一切のコミュニケーションが取れません.
  この状態で帽子の色のどちらかのみを,
  つまり「黒」か「白」のみを2人同時に発言させ,
  その発言とその発言者が被っている帽子の色が一致していれば正解となり,
  そんな正解者が1人でもいれば囚人側の勝利として2人とも釈放されます.
  もし2人とも不正解ならば囚人側の敗北として2人とも処刑されます.
  当たり前ですが看守がどのように帽子を被せるかは,
  囚人たちは入室するまで知りません.
  このゲームのルールや勝利条件については,
  部屋に入る前に囚人たちに伝えられ,
  ゲーム開始までに2人で戦略を相談することが可能です.
  このとき入室後にどのように帽子を被せられても,
  常に囚人側が勝利する戦略は存在するでしょうか？
\end{puzzle}

これはよく知られたパズルで,
今回のパズルの登場人物は看守と囚人になっていますが,
別に看守と囚人でなくても構いませんし,
ゆえにそうでない出題をしているものもたくさんあります.
しかしゲームに臨む動機を作りやすいからか,
またはプレイヤーたちを同様の立場にしたときに協力せざるをえない状況を考えやすいからか,
ゲームに臨む人物のキャラクターは囚人であることが多い印象があります.
ゆえにこのようなパズルは\textgt{囚人と帽子のパズル}と呼ばれることがあります.
\index{しゅうじんとぼうしのぱずる@囚人と帽子のパズル}

英語では\textbf{Hat Puzzle}や\textbf{Hat (Guessing) Game}などと呼ばれます.
\index{Hat Puzzle}
\index{Hat (Guessing) Game}

このパズルの一番の特徴は,
各プレイヤーは自身の帽子の色を言い当てる必要があり,
またその推理のために使える情報は自身の色とは直接は関係ない自分以外の帽子の色という情報のみ,
という点にあります.

この特徴を際立たせるために,
囚人同士はコミュニケーションがとれないという制約がついています.
コミュニケーションには会話だけでなく,
ボディランゲージも含めた,
とにかく情報を伝達する術を全て封じています.

また同時に発言しなくてはいけないというルールも,
仮に同時でなければ,
片方が相手の色を発言して教えてあげ,
もう片方が言い当てるという,
パズルとしては面白くないものになってしまわないためのものです.
もちろんコミュニケーションがとれないという制約の一種とも捉えられます.

このように,
\textgt{自分以外の色の様子のみから自身の色を推測しなくてはいけない},
という要素を持ったパズルをまとめて,
このノートでは\textgt{帽子パズル}と呼ぶことにします.
\index{しゅうじんとぼうしのぱずる@囚人と帽子のパズル!ぼうしぱずる@帽子パズル}
また帽子の色ではなく,
数や記号などが書かれた帽子を被って,
その数や記号を当てるというバリエーションもあります.
また究極的には帽子でなくても構いません.
現に額に色の付いたシールを付けるというものもあります.
なので色付き帽子であることはそこまで重要な要素ではありませんが,
すでに帽子を被る設定のパズルとして流行っているため,
このノートでも帽子パズルと呼んでいくことにします.

看守がどのように帽子を被せるかは規則性も全くなく,
言うなれば看守のそのときの気分ということもありえます.
そうなると以下にゲーム前に作戦を練っても,
ゲーム開始後に得られる情報は,
もう1人の帽子の色という自分の帽子の色とは関係のない情報だけで,
本当に自身の色を当てることができるのか疑問に思います.

しかし,
このパズルの答えは,
そのような最低でも1人は正解する戦略は存在するであり,
その一例は「片方の囚人は相手と同じ色を,
もう片方の囚人は相手と異なる方の色を発言する」というものです.
このような役割で発言すれば,
囚人たちは看守がどのように帽子を被せようとも,
最低でも1人が正解することになります.
つまり囚人たちはどちらがどの役割で発言するかをゲーム前に決めておけばよいだけになります.
また囚人たちがどのようにしてゲームに臨むか（監視カメラとか盗聴とかで）看守は知ることができたとします.
しかしこの作戦は仮に看守に聞かれたとて有効という,
看守の後出しさえ許さない非常に強いものになります.
確かめるために2人の囚人を$a,b$とおくことにします.

たとえば$a$が（何色の帽子が見えてとしても）常に黒と発言する,
$b$は常に白と発言する,
という作戦で臨んだとします.
もちろん看守は彼らの戦略を知らず,
たまたま$a$に白を$b$に黒を被せた場合,
どちらも正解せず囚人側の負けになります.
また上記のように看守がその作戦を事前に知っていれば,
そのように被せることで確実に囚人立ちを負けさせることができます.

しかし,
このパズルの答えになっている作戦は,
仮にゲーム前に作戦が看守に漏れてしまったとしても,
囚人側は必ず勝つことができ,
ゆえに必勝戦略とよぶにふさわしいものになっています.

ではこの作戦が必勝になるのか論理的な・数学的な理由を説明します.

まずは本当に必勝になっているかを確認してみます.
2人の囚人に黒白の2色の帽子を被せる組み合わせは以下の表のように計4つです.

\begin{table}[H]
  \begin{center}
    \begin{tabular}{|c||c|c|c|c|}
    \hline
          & $f_1$ & $f_2$ & $f_3$ & $f_4$ \\ \hline\hline
    $a$ & 黒     & 黒     & 白     & 白     \\ \hline
    $b$ & 黒     & 白     & 黒     & 白  \\\hline
    \end{tabular}
  \end{center}
  \caption{2人2色パズルの帽子の被せ方}
  \label{table:2-2puzzle-coloring}
\end{table}

\noindent
4つの帽子の被せ方にそれぞれ$f_1,f_2,f_3,f_4$と名前を付けておきました.
つまり$f_1$は看守が2人ともに黒と被せた場合にあたります.

そして2人の相談によって,
$a$は見えた色と同じ色を,
$b$は見えた色と異なる色を発言することになったとします.

例えば$f_1$では囚人$a$は,
自分が見えた相手の帽子の色,
つまり囚人$b$が被っている帽子の色と同じ色を発言したいので,
「黒」と発言します.
そして囚人$b$は,
自分が見えた相手の帽子の色と違う色,
つまり囚人$a$が被っている帽子の色と違う方の色を発言したいので,
「白」と発言します.
すると囚人$a$は被っている帽子の色と発言した色が一致しているので正解となり,
残念ながら囚人$b$は不正解でしたが,
勝利条件「1人以上正解である」はみたしているので,
囚人側の勝利となります.

これは$f_1$だから勝利できたわけではありません.
その他の3つの状況においても,
必ず1人は正解することができています.
各帽子の被せ方と,
各囚人がどのような色を発言したかをまとめた表は以下のようになります.
正解した囚人の行には色が付いています.

\begin{table}[H]
  \begin{center}
    \begin{tabular}{|c||c|c||c|c||c|c||c|c|}
      \hline
      \multirow{2}{*}{} & \multicolumn{2}{c||}{$f_1$} & \multicolumn{2}{c||}{$f_2$} & \multicolumn{2}{c||}{$f_3$} & \multicolumn{2}{c|}{$f_4$} \\ \cline{2-9}
                        & 帽子色          & 発言色         & 帽子色          & 発言色         & 帽子色          & 発言色         & 帽子色          & 発言色         \\ \hline\hline
      $a$               & \cellcolor{pink} 黒            & \cellcolor{pink} 黒           & 黒            & 白           & 白            & 黒           & \cellcolor{pink} 白            & \cellcolor{pink} 白           \\ \hline
      $b$               & 黒            & 白           & \cellcolor{pink} 白            & \cellcolor{pink} 白           & \cellcolor{pink} 黒            & \cellcolor{pink} 黒           & 白            & 黒           \\ \hline
    \end{tabular}
  \end{center}
  \caption{必勝戦略における2人2色パズルの帽子の被せ方とその発言}
\end{table}

\noindent
それぞれの場合を見てもらえれば,
確かに1人は正解していることがわかります.

ではこの作戦が必勝になる理由を2通りで説明します.

\subsection*{必勝の理由その1}
\label{subsection:必勝の理由その1}
\subfile{C:/souji/all-note/part/part_研究ノート/chapter_帽子パズル概要/section_帽子パズルとは？/subsection_必勝の理由その1.tex}

\subsection*{必勝の理由その2}
\label{subsection:必勝の理由その2}
\subfile{C:/souji/all-note/part/part_研究ノート/chapter_帽子パズル概要/section_帽子パズルとは？/subsection_必勝の理由その2.tex}

以上の理由で,
囚人たちには必勝戦略が存在します.

またその必勝である理由を見てもらえれば分かる通り,
その理由は論理的・数学的です.
またこれ以外の数学的理由でもって説明することもできると思います.
ゆえにこのパズルは単なる論理パズルを超えて,
さまざまな数学が役立つ可能性を持ったパズルの1つです.

\PuzzleRef{puzzle:hat-Hardin-Taylor}は（おそらく）考案者のHardinとTaylorの名前をとって,
\textbf{Hardin}-\textbf{Taylor}\textgt{の帽子パズル}と呼んでいます.
\index{しゅうじんとぼうしのぱずる@囚人と帽子のパズル!はーでぃんていらーのぼうしぱずる@Hardin-Taylorの帽子パズル}
このパズルは様々な種類のある帽子パズルの中で最もシンプルなものになります.
ここからルールや設定を変えることで様々なバリエーションが生まれます.
それについては\SecRef{section:バリエーション}で紹介します.

そしてこのパズルは出題方法こそ違えど,
同様の仕組みを持つパズルはかなり昔から知られています.
帽子パズルの歴史については\SecRef{section:帽子パズルの歴史}で紹介します.

私の中で最も研究が進んでいるのはHardin-Taylorの帽子パズルです.
なのでこの研究ノートでも主にそのパズルを対象としていますが,
どんなパズルであれ,
帽子パズルを数学的に研究するには,
上で紹介した理由の2つ以上に,
パズルに登場する「戦略」とか「作戦」などといった概念を,
数学概念を使って書き直す必要がでてきます.
こういった作業は「形式化」と呼ばれますが,
そのやり方は\SecRef{section:帽子パズルの形式化}で紹介します.

そして形式化が完了すると,
Hardin-Taylorの帽子パズルについての様々な限界が見えてきます.
たとえば\PuzzleRef{puzzle:hat-Hardin-Taylor}では,
どのような作戦で臨んでも常に2人正解させることはできません.
そういった数学的事実を\SecRef{section:帽子パズルの限界}で紹介します.

帽子パズルは様々な方法で分類できますが,
1番シンプルなものは\PuzzleRef{puzzle:hat-Hardin-Taylor}のように,
パズルに登場するプレイヤー数も帽子に付いている色の種類数も有限なものか,
そのどちらか一方が無限になっているものです.
つまり登場する数や種類数がどちらも有限になっているもの,
そうでないものに分けます.
前者を単に\textgt{有限帽子パズル}と,
後者を\textgt{無限帽子パズル}と呼ぶことにします.
\index{しゅうじんとぼうしのぱずる@囚人と帽子のパズル!ゆうげんぼうしぱずる@有限帽子パズル}
\index{しゅうじんとぼうしのぱずる@囚人と帽子のパズル!むげんぼうしぱずる@無限帽子パズル}
それぞれについて様々な研究が既にあります.
先行研究や私の研究についてまとめていきたいので,
有限パズルについては\ChapRef{chapter:有限な帽子パズル}で,
無限パズルについては\ChapRef{chapter:無限な帽子パズル}で紹介します.
ちなみに上記の\SecRef{section:帽子パズルの限界}では有限・無限関係なく一般的な結果をまとめてあります.

帽子パズル以外にも数学者が注目しているパズルはたくさんあります.
帽子パズルを他のパズルと関連付けるような結果が出せています.
そんな結果については\ChapRef{chapter:他のパズルとの関係}で紹介します.

帽子パズルや,
関連性があるパズルについての論文はこれからたくさん読んでいくことになります.
それらのメモや要約を文献ごとにまとめて紹介しているのが,
\ChapRef{chapter:論文精読と文献調査}です.

そして帽子パズルだけをテーマにした数学書が存在します.
そのテキストは帽子パズルを研究するうえでも重要なものになります.
もとの章構成そのままに自分で読んでみて考えたことなどもまとめたものが\PartRef{part:帽子パズル本精読ノート}です.

\end{document}
