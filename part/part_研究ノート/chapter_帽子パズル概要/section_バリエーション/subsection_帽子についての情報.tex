\documentclass[C:/souji/all-note/note]{subfiles}

\begin{document}

帽子パズルにて「帽子についての情報」として基本的なものは,
色の付いた帽子がそれぞれいくつあるかというものです.
またこの情報があればあるほど囚人たちは有利になります.
一番囚人たちにとって役に立ちづらい情報は,
全ての色の帽子が囚人の数だけ用意されている場合です.
この場合は帽子の被せ方の全てのパターンがありえることになります.
Hardin-Taylorの帽子パズルの一番シンプルな場合である\PuzzleRef{puzzle:hat-Hardin-Taylor}がそのようなパズルの代表例です.
囚人たちが協力できない帽子パズルでは,
この情報が重要になります.
なぜなら被せ方の全てのパターンがありえるという情報だけならば,
囚人はもはや色の数だけ発言の可能性を持つことになり,
一向にその自身の色の繋がる推論をすることができないからです.

この情報が増えるだけで,
正解数という点で囚人たちが有利になることを,
Puzzle \ref{puzzle:hat-Hardin-Taylor}を改造することで確かめてみます.

\begin{puzzle}
  看守があるゲームをするために2人の囚人$a,b$を同じ部屋に入れ,
  帽子を1人に1つずつ被せます.
  その帽子は黒白どちらかの色で塗られています.
  {\color{red} しかし黒で塗られた帽子は1つしかありません.
  白のものは2つあります}.
  囚人2人はそれぞれ自分が被っている帽子の色は分かりませんが,
  もう1人の囚人の帽子の色は見えています.
  また部屋に入ってからは互いに一切のコミュニケーションが取れません.
  この状態で帽子の色のどちらかのみを,
  つまり「黒」か「白」のみを2人同時に発言させ,
  その発言とその発言者が被っている帽子の色が一致していれば正解となり,
  そんな正解者が1人ならば囚人側の勝利として2人とも釈放されます.
  もし正解者が2人ならば釈放した上に賞金がもらえます.
  もし2人とも不正解ならば囚人側の敗北として2人とも処刑されます.
  当たり前ですが看守がどのように帽子を被せるかは,
  囚人たちは入室するまで知りません.
  このゲームのルールや勝利条件については,
  部屋に入る前に囚人たちに伝えられ,
  ゲーム開始までに2人で戦略を相談することが可能です.
  このとき入室後にどのように帽子を被せられても,
  最低でも1人正解,
  帽子の被せ方次第では2人が正解するような戦略は存在するでしょうか？
\end{puzzle}

つまりこのパズルは正解数に応じてボーナスが付くようになりました.
もちろん囚人は最低限負けることはなく,
あわよくばボーナスも得られるような作戦を考えるはずです.
そしてそんな作戦はもとのパズルでの必勝戦略を改造することで得られます.
ちなみに元のパズルでの必勝戦略とは$a$が見えた色と同じ色を,
$b$が見えた色と違う方の色を発言するというものでした.

\begin{answer}
  囚人たちは以下のように作戦を立てます.
  $a$も$b$も基本的にはPuzzle \ref{puzzle:hat-Hardin-Taylor}のときと同じように発言しますが,
  もし黒色が見えた場合は元の作戦は気にせず白と発言します.
  これは黒黒という組み合わせがありえないということを考慮したうえでの作戦です.
  すると個々の被せ方パターンにおける発言は以下のようになります.
  比較のために元のパズル通りの作戦での発言も併記しておきます.
  ※は「Puzzle \ref{puzzle:hat-Hardin-Taylor}での発言」の省略です.

  \begin{table}[H]
    \begin{center}
      \begin{tabular}{c||c|c|c||ccc||ccc}
            & \multicolumn{3}{c||}{パターン1} & \multicolumn{3}{c||}{パターン2} & \multicolumn{3}{c}{パターン3} \\ \hline
            & 帽子色 & Puzzle \ref{puzzle:hat-Hardin-Taylor}での発言 & 発言色 & 帽子 & ※ & 発言 & 帽子 & ※ & 発言     \\ \hline\hline
        $a$ & 黒 & 白 & 白 & 白 & 黒 & 白 & 白 & 白 & 白  \\
        $b$ & 白 & 白 & 白 & 黒 & 黒 & 黒 & 白 & 黒 & 黒
      \end{tabular}
    \end{center}
  \end{table}

  またPuzzle \ref{puzzle:hat-Hardin-Taylor}ではありえた2人とも黒を被っているというパターンがなくなっています. \\
  パターン1と3の場合はPuzzle \ref{puzzle:hat-Hardin-Taylor}と同じような発言をするので,
  正解者は1人のままですが,
  パターン2の場合に$a$が黒が見えたために,
  元の作戦通りに黒と発言せず白と発言しています.
  そうすることでこの場合には2人が正解しています.
  よってこのような作戦で囚人たちは最低でも2人,
  パターン2のような場合だけ2人正解するような作戦を立てることができます.
\end{answer}

もしPuzzle \ref{puzzle:hat-Hardin-Taylor}にも,
2人正解した場合のボーナスを設定したとします.
しかしどのような戦略で臨んでも,
最低1人の正解を保証しつつ上手くいけば2人が正解するような作戦は存在しないことを証明することができます.
つまりどんな必ず釈放される作戦もパターンごとの平均正解者数は1人ちょうどになります.
上記のパズルでは平均正解者数は$\frac{4}{3}$人になっており,
その観点からも囚人たちは有利になっています.

\SecRef{subsection:囚人数・色の数と帽子をどう見分けるか？}でも紹介した,
帽子に色ではなく数字が書いてあるという設定を考えると,
囚人たちに与える帽子について情報はより多彩になります.
たとえば全ての囚人の数字は連続しているとかはどうでしょうか？
また全ての囚人の数字の和は誰か1人の数字に一致するとか,
1人の囚人の数字は他の囚人の和に等しいとか,
色では表現できなかった情報を囚人たちに与えることができます.

囚人も色の数も無限になれば,
さらに数学的な情報も検討できます.
たとえば各囚人に自然数が1つずつ割り振られていて,
帽子に書かれる数字の候補も全ての自然数から選ばれるとすれば,
全ての囚人に1つずつ帽子を被せれば,
それは1つの自然数列を与えたことと同じ意味になります.
ここで看守からその数列（つまり帽子の様子）は収束するというヒントを与えられたらどうでしょうか？
このようにして無限の場合は数学概念を用いたより多彩で複雑な帽子パズルを考えることもできます.

\end{document}
